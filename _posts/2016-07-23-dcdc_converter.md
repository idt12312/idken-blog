---
layout: post
title: DCDCコンバータの出力コンデンサ
category: 電子工作
tag:
    - DC-DCコンバータ
    - 玉乗りロボット
comments: true
thumb: /images/thumb_dcdc.jpg
---
玉乗りロボットの制御基板の電源供給に使っていたDCDCコンバータの出力コンデンサを
適当な電解コンデンサから積層セラミックコンデンサに変えたら、出力のリプルが劇的に減りました。


# なんか電源が揺れてる
玉乗りロボットのエンコーダのノイズと戦っていた時、エンコーダの信号をオシロでみるとこんな感じになっていました。

![](/images/enc_sign.jpg)

玉乗りロボットの制御基板の電源がだめなのではと思い、
エンコーダに電源を供給している5Vラインと、マイコンに電源を供給する3.3Vラインをオシロ(AnalogDiscovery)でみると
特に5Vラインが揺れまくっていました。

![](/images/dcdc_before.jpg)

3.3V、5Vともに電源にはAP6502というICを中心に降圧のDC-DCコンバータを構成しています。
オシロの写真をみると出力は150kHzくらいの大きな変化とと300kHzくらいの細かい振動が見られます。
AP6502のスイッチング周波数は340kHくらいなので、このIC周りで何か起こっているみたいです。


# DC-DCコンバータの揺れ
DC-DCコンバータはスイッチングをしているので、どうしても出力が揺れてしまうのですが、
出力コンデンサのESRやインダクタの大きさによってその揺れの具合が変わってくるらしいです。
[ROHMさんの解説](http://micro.rohm.com/jp/techweb/knowledge/dcdc/dcdc_pwm/dcdc_pwm02/2366)

今回は何も考えずに出力には電解コンデンサを使っていましたが、
この電解コンデンサのESRが大きかったとこが電源ラインの揺れが大きくなっていた原因になっていたみたいです。

電解コンデンサをセラミックコンデンサ(一般的に電解コンデンサよりもESRが低い)に交換しました。

![](/images/dcdc.jpg)

その結果、出力の揺れはかなり小さくなりました。


![](/images/dcdc_after.jpg)


# おわりに
なんとなく、積層セラミックコンデンサは大きくても10uFくらいまででそれ以上は電解コンデンサと思っていました。
最近は100uFくらいの積層セラミックコンデンサも秋月とかに置いてあるみたいです。(耐電圧は低いですが)

